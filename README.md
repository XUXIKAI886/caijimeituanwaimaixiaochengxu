# 呈尚策划 美团外卖数据工具

> **⚠️ 重要声明：仅供公司内部测试使用，禁止商用**

一个基于Python和tkinter构建的美团外卖数据采集和处理工具，提供图形化界面，支持自动数据解析、图片下载和Excel报告生成。

## 🚀 功能特点

- **📱 简洁界面**: 基于tkinter的现代化桌面GUI
- **📊 数据解析**: 自动解析美团数据文件格式
- **🖼️ 图片下载**: 异步批量下载产品图片
- **📈 Excel报告**: 生成详细的数据分析报告
- **⏱️ 实时监控**: 自动监控数据文件变化
- **📋 进度跟踪**: 实时显示处理进度和统计信息
- **📝 日志记录**: 完整的操作日志和错误追踪

## 📋 系统要求

- **操作系统**: Windows 7/8/10/11 (64位)
- **Python版本**: 3.7+ (开发环境)
- **网络连接**: 用于下载产品图片
- **存储空间**: 至少100MB可用空间

## 🛠️ 安装说明

### 方式1: 直接使用exe文件 (推荐)
1. 下载 `呈尚策划_美团外卖数据工具.exe`
2. 准备数据文件到指定目录
3. 双击运行，无需安装依赖

### 方式2: 从源码运行
```bash
# 克隆仓库
git clone https://github.com/XUXIKAI886/caijimeituanwaimaixiaochengxu.git
cd caijimeituanwaimaixiaochengxu

# 安装依赖
pip install -r requirements.txt

# 运行程序
python main.py
```

## 📁 数据文件准备

程序需要在以下路径准备数据文件：
```
D:\ailun\
├── xiaochengxumeituan.txt      # 店铺分类数据文件
└── xiaochengxumeituan01.txt    # 产品详细数据文件
```

## 🎯 使用方法

### 1. 启动程序
- **exe版本**: 双击 `呈尚策划_美团外卖数据工具.exe`
- **源码版本**: 运行 `python main.py` 或双击 `启动程序.bat`

### 2. 程序操作
1. **自动监控**: 程序启动后自动开始监控数据文件变化
2. **手动采集**: 点击"开始采集数据"按钮手动执行
3. **监控控制**: 可手动启动/停止文件监控功能
4. **查看结果**: 点击"打开输出文件夹"查看生成的文件

### 3. 输出文件
```
输出文件\
├── 产品图片\                           # 下载的产品图片
│   ├── product_1.jpg
│   ├── product_2.jpg
│   └── ...
└── 美团外卖数据报告_20250821_103045.xlsx   # Excel数据报告
```

## 🏗️ 项目结构

```
├── main.py                     # 主程序入口
├── requirements.txt            # Python依赖包
├── 启动程序.bat               # Windows启动脚本
├── 使用说明.md                # 详细使用说明
├── 打包说明.md                # 开发者打包指南
├── 部署包使用说明.md          # 最终用户部署指南
├── CLAUDE.md                  # Claude Code 开发配置
├── build_exe.spec             # PyInstaller打包配置
├── .gitignore                 # Git忽略文件配置
└── test_*.py                  # 各种功能测试文件
```

## 🔧 开发说明

### 核心架构
- **MeituanDataCollector**: 主应用程序类，管理GUI和业务逻辑
- **FileChangeHandler**: 文件监控处理器，基于watchdog库
- **异步处理**: 使用asyncio和aiohttp进行并发图片下载
- **线程安全**: GUI更新通过线程安全机制处理

### 主要依赖
```python
requests>=2.28.0      # HTTP请求
aiohttp>=3.8.0        # 异步HTTP客户端
openpyxl>=3.1.0       # Excel文件处理
Pillow>=9.0.0         # 图片处理
watchdog>=3.0.0       # 文件监控
aiofiles>=23.0.0      # 异步文件操作
```

### 打包为exe
```bash
# 使用PyInstaller打包
pip install pyinstaller
pyinstaller build_exe.spec

# 生成的exe文件位于 dist/ 目录
```

## 📊 功能详解

### 数据处理流程
1. **文件解析**: 读取JSON格式的美团数据文件
2. **分类匹配**: 解析店铺分类信息并与产品关联
3. **数据合并**: 合并多个数据源的产品信息
4. **图片下载**: 异步下载产品图片到本地
5. **报告生成**: 创建包含完整信息的Excel报告

### 监控机制
- **实时监控**: 监控指定目录的文件变化
- **防抖处理**: 避免频繁触发，设置3秒防抖时间
- **自动处理**: 检测到文件更新后自动重新处理数据

## ⚠️ 注意事项

### 使用限制
- **内部使用**: 仅供公司内部测试，严禁商业用途
- **数据安全**: 请确保数据文件的安全性和合规性
- **网络要求**: 图片下载需要稳定的网络连接

### 常见问题
1. **程序无法启动**: 检查Python环境或尝试以管理员身份运行
2. **文件读取失败**: 确认数据文件路径和格式正确
3. **图片下载缓慢**: 检查网络连接或调整并发数量
4. **杀毒软件误报**: 将程序添加到杀毒软件白名单

## 📞 技术支持

如遇到问题，请提供以下信息：
- 错误截图或描述
- 程序日志文件 (`采集日志.log`)
- 操作系统版本
- 数据文件格式

## 📄 许可声明

本项目仅供呈尚策划公司内部测试使用，未经授权禁止用于商业用途。

---

**开发团队**: 呈尚策划技术部  
**最后更新**: 2025年8月21日